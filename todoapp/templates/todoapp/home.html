{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baños Beauchef</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
</head>
<body>
    <header class="window-container navbar">
        <div class="navbar-brand">
            <span class="app-title">Baños Beauchef</span>
        </div>
        <div class="user-info">
            {% if user.is_authenticated %}
                <span class="username">Bienvenido, {{ user.username }}</span>
                <a href="{% url 'logout' %}" class="logout-btn">Cerrar Sesión</a>
            {% else %}
                <a href="{% url 'login' %}" class="logout-btn">Iniciar Sesión</a>
                <a href="{% url 'register_user' %}" class="logout-btn">Registrarse</a>
            {% endif %}
        </div>
        <div class="mobile-menu-toggle">
            <button id="mobile-menu-btn">&#9776;</button>
        </div>
    </header>

    <main class="container">
        <div class="window-container filter-container">
            <aside class="filter">
                <h4>Filtro</h4>
                <form method="get" id="filterForm">
                    <label for="building">Edificio:</label>
                    <select name="building" id="building">
                        <option value="">Todos los edificios</option>
                        {% for building in buildings %}
                            <option value="{{ building }}" {% if building == selected_building %}selected{% endif %}>
                                {{ building }}
                            </option>
                        {% endfor %}
                    </select>
            
                    <label for="floor">Piso:</label>
                    <select name="floor" id="floor">
                        <option value="">Todos los pisos</option>
                        {% for floor in floors %}
                            <option value="{{ floor }}" {% if floor|stringformat:"i" == selected_floor %}selected{% endif %}>
                                {{ floor }}
                            </option>
                        {% endfor %}
                    </select>
            
                    <label for="gender">Gender:</label>
                    <select name="gender" id="gender">
                        <option value="">All Genders</option>
                        {% for gender in genders %}
                            <option value="{{ gender }}" {% if gender == selected_gender %}selected{% endif %}>
                                {{ gender|title }}
                            </option>
                        {% endfor %}
                    </select>
            
                    <button type="submit">Filter</button>
                </form>
            </aside>
        </div>

        <div class="window-container bathroom-list-container">
            <section class="bathroom-list">
                <h2>Lista de Baños</h2>
                <!-- Aquí va la lista dinámica de imágenes -->
                <div class="card">
                    {% for bathroom in bathrooms %}
                    <a href="/bathroom/{{ bathroom.id}}" class="card-link">
                    <div class="card-body">
                        <h5 class="card-title">{{ bathroom.name }}</h5>
                        <p class="card-text">Edificio {{ bathroom.building }}, Piso {{ bathroom.floor }}.</p>
                        <p class="card-text">Género: {{ bathroom.get_gender_display }}.</p>
                    </div>
                    </a>
                    {% endfor %}
                </div>
                <!-- Repetir para cada imagen -->
            </section>
        </div>

        <div class="window-container add-button-container">
            <aside class="add-button">
                <p class="add-button-text">¿No encuentras tu baño preferido? ¡Agrega tu baño aquí!</p>
                <a class="btn btn-primary btn-block" href="/add_bathroom">Agregar Baño</a>
            </aside>
        </div>
    </main>
    
    <!-- JavaScript para manejar el menú móvil -->
    <script src="{% static 'js/home.js' %}"></script>
    <script>
        // JavaScript to dynamically update floors and bathrooms based on building selection
        document.getElementById('building').addEventListener('change', function() {
            document.getElementById('filterForm').submit();
        });

        document.getElementById('floor').addEventListener('change', function() {
            document.getElementById('filterForm').submit();
        });

        document.getElementById('gender').addEventListener('change', function() {
            document.getElementById('filterForm').submit();
        });
    </script>
</body>
</html>
